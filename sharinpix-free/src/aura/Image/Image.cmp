<aura:component implements="force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes" access="global" controller="ImageController">
	<aura:attribute name="recordId" type="String"/>
	<aura:attribute name="loading" type="Boolean"/>
	<aura:attribute name="errorMessage" type="String"/>
	<aura:dependency resource="ui:message"/>
	<aura:attribute name="images" type="Object[]"/>
	<aura:attribute name="image" type="Object"/>
	<aura:attribute name="index" type="Integer"/>
	<aura:attribute name="total" type="Integer"/>
	<aura:handler name="init" value="{! this }" action="{! c.doInit }"/>
  	<aura:handler event="aura:locationChange" action="{! c.doReload }"/>
  	<aura:handler name="change" value="{! v.recordId }" action="{! c.doReload }"/>
  	<aura:method name="reload" action="{! c.doReload }"/>
	<aura:handler event="c:Uploaded" action="{!c.uploaded}"/>
	<aura:handler event="c:ErrorHandling" action="{!c.displayError}"/>

	<aura:if isTrue="{! v.errorMessage }">
      <ui:message title="Error" severity="Error" class="errormessages">
        {! v.errorMessage }
      </ui:message>
    </aura:if>
	<div class="image-container">
		<aura:if isTrue="{! v.loading }">
			<lightning:spinner />
		<aura:set attribute="else">
			<aura:if isTrue="{! v.total > 0 }">
			<c:SingleImage attachmentId="{!v.image.Id}" />
	    		<aura:set attribute="else">
	    			<div class="uploader-no-images-btn">
					<c:Uploader recordId="{!v.recordId}" label="Upload Images"/>
	    			</div>
	    		</aura:set>
	    	</aura:if>
	    	<aura:if isTrue="{! v.total > 1 }">
	    		<button class="control control-previous" label="Previous" onclick="{! c.doPrevious }">
	    			<lightning:icon iconName="utility:chevronleft" size="large" alternativeText="Previous Image"/>
		    	</button>
		    	<button class="control control-next" label="Next" onclick="{! c.doNext }">
		    		<lightning:icon iconName="utility:chevronright" size="large" alternativeText="Next Image"/>
		    	</button>
		    </aura:if>
		    <aura:if isTrue="{! v.total > 0 }">
		    	<div class="uploader-btn">
				<c:Uploader recordId="{!v.recordId}"/>
		    	</div>
		    	<button class="delete-btn" label="Delete" onclick="{! c.doDelete }" title="Delete">
					<lightning:icon iconName="action:delete" alternativeText="Delete"/>
				</button>
			</aura:if>
		</aura:set>
		</aura:if>
	</div>
</aura:component>