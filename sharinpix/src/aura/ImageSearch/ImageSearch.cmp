<aura:component access="GLOBAL"
                implements="flexipage:availableForAllPageTypes,forceCommunity:availableForAllPageTypes,force:appHostable"
                controller="SharinPixImageSearchController">
    <lightning:spinner variant="brand" size="large" aura:id="lexSpinner" alternativeText="Fetching tags and reports..."/>

    <aura:attribute name="showQueryPanel" type="boolean" default="true" access="global"/>
    <aura:attribute name="allowQueryByTag" type="boolean" default="true" access="global"/>
    <aura:attribute name="showResultsPanel" type="boolean" default="false"/>

    <aura:attribute name="reportId" type="String" access="global"/>
    <aura:attribute name="reportParameters" type="String" access="global"/>

    <aura:attribute name="tagOperator" type="String" default=""/>
    <aura:attribute name="selectedTags" type="String" access="global"/>
    <aura:attribute name="tagOptions" type="Object"/>

    <aura:attribute name="albumIds" type="String" access="private"/>

    <aura:handler name="init" value="{! this }" action="{! c.doInit }"/>
    <aura:handler event="aura:waiting" action="{! c.startLexSpinner }"/>
    <aura:handler event="aura:doneWaiting" action="{! c.stopLexSpinner }"/>

    <aura:attribute name="pageSize" type="Integer" default="2" access="global"/>

    <div class="slds-form--stacked slds-m-around--small">
        <div class="slds-grid slds-wrap slds-grid--pull-padded slds-grid--align-center">
            <div class="slds-p-horizontal--small slds-size--1-of-1 slds-medium-size--4-of-6 slds-large-size--6-of-12">
                <aura:if isTrue="{! v.showQueryPanel }">
                    <c:ReportsQuery reportId="{! v.reportId }" reportParameters="{! v.reportParameters }"/>

                    <aura:if isTrue="{! v.allowQueryByTag }">
                        <c:TagsQuery tagOperator="{! v.tagOperator }" selectedTags="{! v.selectedTags }"/>
                    </aura:if>

                    <div class="slds-form-element center">
                        <lightning:button class="page-btn" onclick="{! c.doSearch }">
                            <lightning:icon iconName="utility:search" size="xx-small" alternativeText=""/>
                            &nbsp;Go
                        </lightning:button>
                        <lightning:button class="page-btn" onclick="{! c.clearInput }">
                            <lightning:icon iconName="utility:clear" size="xx-small" alternativeText=""/>
                            &nbsp;Clear
                        </lightning:button>
                    </div>
                </aura:if>
            </div>
        </div>

        <div style="{! 'display: ' + (v.showResultsPanel ? 'block' : 'none') }">
            <c:QueryResults aura:id="queryResults" albumIds="{! v.albumIds }" tagOptions="{! v.tagOptions }" pageSize="{! v.pageSize }"/>
        </div>
    </div>
</aura:component>